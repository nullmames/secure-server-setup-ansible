---
- name: Run setup and secure playbooks
  hosts: all
  gather_facts: true
  become: true
  vars_files:
    - "{{ user_file }}"

  pre_tasks:
    - name: Verify sudo
      ansible.builtin.shell: "sudo w"
      delegate_to: localhost

  roles:
    - setup
    - secure

- name: Import zabbix playbook
  ansible.builtin.import_playbook: util_install_zabbix.yml
